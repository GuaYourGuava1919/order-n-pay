(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"536e":function(t,e,a){"use strict";var s=a("bc7b"),n=a("1902"),o=a("1494");const i={apiKey:"AIzaSyCBtwlgaAmqFR9rpQ-b6chUDV-6QGaNdnQ",authDomain:"order-n-pay.firebaseapp.com",projectId:"order-n-pay",storageBucket:"order-n-pay.appspot.com",messagingSenderId:"198387957066",appId:"1:198387957066:web:37cd03ae01e54e79be55b3",measurementId:"G-4QG8HNSB8D"},c=Object(s["a"])(i);Object(n["a"])(c),Object(o["f"])(c);var r,l,u=c,m=u,p=a("2877"),d=Object(p["a"])(m,r,l,!1,null,null,null);e["a"]=d.exports},"713b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("q-layout",{attrs:{view:"lHh Lpr lFf"}},[e("q-header",{attrs:{elevated:""}},[e("q-toolbar",[t.uid?e("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu"},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}}):e("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu"},on:{click:function(e){t.alert=!0}}}),e("q-toolbar-title",{on:{click:function(e){return t.goto()}}},[t._v(" Order-n-Pay ")]),t.uid?e("q-btn",{attrs:{outline:"",rounded:"",label:"登出"},on:{click:t.tosignOut}}):e("q-btn",{attrs:{push:"",rounded:"",color:"secondary",label:"登入/註冊"},on:{click:t.toggle}})],1)],1),t.uid?e("q-drawer",{attrs:{"show-if-above":"",bordered:"","content-class":"bg-grey-1"},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[e("q-list",[e("q-item-label",{staticClass:"text-grey-8",attrs:{header:""}},[t._v(" 功能列表 ")]),t._l(t.essentialLinks,(function(a){return e("EssentialLink",t._b({key:a.title},"EssentialLink",a,!1))}))],2)],1):t._e(),e("q-page-container",[e("router-view")],1),e("SignUp"),e("SignIn"),e("q-dialog",{model:{value:t.alert,callback:function(e){t.alert=e},expression:"alert"}},[e("q-card",[e("q-card-section",[e("div",{staticClass:"text-h6"},[t._v("請先登入")])]),e("q-card-section",{staticClass:"q-pt-none"},[t._v("\n        大哥，你還沒登入；登入才能用喔！\n      ")]),e("q-card-actions",{attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"好喔",color:"primary"}})],1)],1)],1)],1)},n=[],o=(a("14d9"),function(){var t=this,e=t._self._c;return e("q-item",{staticClass:"text-primary",attrs:{clickable:"",tag:"a",target:"_blank"},on:{click:function(e){return t.gotoPage(t.link)}}},[t.icon?e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{name:t.icon}})],1):t._e(),e("q-item-section",[e("q-item-label",[t._v(t._s(t.title))])],1)],1)}),i=[],c={name:"EssentialLink",props:{title:{type:String,required:!0},caption:{type:String,default:""},link:{type:String,default:"#"},icon:{type:String,default:""}},methods:{gotoPage(t){this.$router.push(t)}}},r=c,l=a("2877"),u=a("66e5"),m=a("4074"),p=a("0016"),d=a("0170"),b=a("eebe"),h=a.n(b),g=Object(l["a"])(r,o,i,!1,null,null,null),q=g.exports;h()(g,"components",{QItem:u["a"],QItemSection:m["a"],QIcon:p["a"],QItemLabel:d["a"]});var f=function(){var t=this,e=t._self._c;return e("q-dialog",{attrs:{persistent:""},model:{value:t.open,callback:function(e){t.open=e},expression:"open"}},[e("q-card",{staticStyle:{width:"90vw"}},[e("q-form",{on:{submit:t.signUp,reset:t.onClose}},[e("q-card-section",{staticClass:"q-ma-md q-pb-md flex justify-center items-center text-h6"},[t._v("\n        註冊\n      ")]),e("q-card-section",{staticClass:"q-ma-md"},[e("q-input",{staticClass:"q-mb-md",attrs:{filled:"",label:"請輸入名稱","hide-bottom-space":"","lazy-rules":"",rules:[t=>t&&t.length>0||"名稱不能為空"]},model:{value:t.account.name,callback:function(e){t.$set(t.account,"name",e)},expression:"account.name"}}),e("q-select",{staticClass:"q-mb-md",attrs:{filled:"",options:t.options,label:"選擇常用付款方式","hide-bottom-space":"","lazy-rules":"",rules:[t=>t&&t.length>0||"付款方式不能為空"]},model:{value:t.account.payment,callback:function(e){t.$set(t.account,"payment",e)},expression:"account.payment"}}),e("q-input",{staticClass:"q-mb-md",attrs:{filled:"",label:"請輸入常用銀行帳號(選填)"},model:{value:t.account.bankAccount,callback:function(e){t.$set(t.account,"bankAccount",e)},expression:"account.bankAccount"}}),e("q-input",{staticClass:"q-mb-md",attrs:{filled:"",type:"email",label:"請輸入電子郵件","hide-bottom-space":"","lazy-rules":"",rules:[t=>!!t||"電子郵件不能為空",t=>/.+@.+\..+/.test(t)||"請輸入有效的電子郵件地址"]},model:{value:t.account.email,callback:function(e){t.$set(t.account,"email",e)},expression:"account.email"}}),e("q-input",{staticClass:"q-mb-md",attrs:{filled:"",label:"請輸入密碼",type:"password","hide-bottom-space":"","lazy-rules":"",rules:[t=>!!t||"密碼不能為空",t=>t&&t.length>=6||"密碼至少需要6個字符"]},model:{value:t.account.password,callback:function(e){t.$set(t.account,"password",e)},expression:"account.password"}})],1),e("q-card-actions",{staticClass:"text-primary q-ma-md",attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm",attrs:{label:"取消",type:"reset",color:"primary",flat:""}}),e("q-btn",{attrs:{label:"註冊",type:"submit",color:"primary"}})],1)],1)],1)],1)},y=[],w=a("be8c"),C=a("536e"),v=a("1494"),k={name:"SignUp",data(){return{account:{email:"",password:"",name:"",payment:"",bankAccount:""},options:["Line Pay","現金支付","銀行轉帳"]}},computed:{open:{get(){return this.$store.state.openSignUp},set(t){this.$store.commit("setOpenSignUp",t)}}},methods:{onClose(){this.account={}},async signUp(){try{this.$q.loading.show();const t=Object(w["b"])(C["a"]),e=Object(v["f"])(C["a"]),a=await Object(w["a"])(t,this.account.email,this.account.password),s=(await Object(v["g"])(Object(v["c"])(e,"user",a.user.uid),{name:this.account.name,email:this.account.email,auth:"normal",payment:this.account.payment,bankAccount:this.account.bankAccount}),await Object(w["c"])(t,this.account.email,this.account.password));localStorage.setItem("currentUser",JSON.stringify(s.user)),this.$store.commit("setCurrentUser",s.user),window.location.reload(),this.onClose(),this.$q.loading.hide()}catch(t){console.log(t),this.$q.notify({message:"註冊失敗",color:"negative",icon:"error"})}}}},O=k,Q=a("24e8"),S=a("f09f"),$=a("0378"),I=a("a370"),_=a("27f9"),j=a("ddd8"),x=a("4b7e"),U=a("9c40"),D=a("7f67"),L=Object(l["a"])(O,f,y,!1,null,"147ca864",null),A=L.exports;h()(L,"components",{QDialog:Q["a"],QCard:S["a"],QForm:$["a"],QCardSection:I["a"],QInput:_["a"],QSelect:j["a"],QCardActions:x["a"],QBtn:U["a"]}),h()(L,"directives",{ClosePopup:D["a"]});var z=function(){var t=this,e=t._self._c;return e("q-dialog",{attrs:{persistent:""},model:{value:t.open,callback:function(e){t.open=e},expression:"open"}},[e("q-card",{staticStyle:{width:"90vw"}},[e("q-icon",{staticClass:"q-ma-md",attrs:{name:"close",size:"2em",color:"primary"},on:{click:t.onClose}}),e("q-form",{on:{submit:t.signIn}},[e("q-card-section",{staticClass:"q-mx-md no-padding flex justify-center items-center text-h6"},[t._v("\n        登入\n      ")]),e("q-card-section",{staticClass:"q-ma-sm"},[e("q-input",{staticClass:"q-mb-md",attrs:{filled:"",type:"email",label:"請輸入電子郵件","hide-bottom-space":"","lazy-rules":"",rules:[t=>!!t||"電子郵件不能為空",t=>/.+@.+\..+/.test(t)||"請輸入有效的電子郵件地址"]},model:{value:t.account.email,callback:function(e){t.$set(t.account,"email",e)},expression:"account.email"}}),e("q-input",{staticClass:"q-mb-md",attrs:{filled:"",label:"請輸入密碼",type:"password","hide-bottom-space":"","lazy-rules":"",rules:[t=>!!t||"密碼不能為空",t=>t&&t.length>=6||"密碼至少需要6個字符"]},model:{value:t.account.password,callback:function(e){t.$set(t.account,"password",e)},expression:"account.password"}})],1),t.loginError?e("q-card-actions",{staticClass:"error-message q-ma-md flex justify-center"},[e("q-chip",{attrs:{color:"negative","text-color":"white",icon:"sentiment_dissatisfied"}},[t._v("\n          "+t._s(this.loginError)+"\n        ")])],1):t._e(),e("q-card-actions",{staticClass:"text-primary q-ma-md",attrs:{align:"right"}},[e("q-btn",{staticClass:"q-ml-sm",attrs:{label:"註冊",color:"primary",flat:""},on:{click:t.switchDialog}}),e("q-btn",{attrs:{label:"登入",type:"submit",color:"primary"}})],1)],1)],1)],1)},E=[],N={name:"SignIn",data(){return{account:{email:"",password:""},loginError:""}},computed:{open:{get(){return this.$store.state.openSignIn},set(t){this.$store.commit("setOpenSignIn",t)}}},methods:{onClose(){this.open=!1,this.account={}},async getCurrentUserInfo(t){const e=Object(v["f"])(C["a"]),a=await Object(v["d"])(Object(v["c"])(e,"user",t));this.$store.commit("setCurrentUserInfo",a.data())},async signIn(){const t=Object(w["b"])(C["a"]);try{this.$q.loading.show();const e=await Object(w["c"])(t,this.account.email,this.account.password);e.user&&(localStorage.setItem("currentUser",JSON.stringify(e.user)),this.$store.commit("setCurrentUser",e.user),await this.getCurrentUserInfo(e.user.uid),window.location.reload(),this.onClose(),this.$q.loading.hide())}catch(e){this.loginError="登入失敗，請檢查帳號密碼是否正確",this.$q.loading.hide()}},switchDialog(){this.$store.commit("openSignUpDialog"),this.$store.commit("openSignInDialog")}},mounted(){}},P=N,B=a("b047"),J=Object(l["a"])(P,z,E,!1,null,"7c700d6e",null),F=J.exports;h()(J,"components",{QDialog:Q["a"],QCard:S["a"],QIcon:p["a"],QForm:$["a"],QCardSection:I["a"],QInput:_["a"],QCardActions:x["a"],QChip:B["a"],QBtn:U["a"]});const G=[{title:"點餐功能",caption:"開單、點餐、常用餐廳資訊",icon:"local_dining",link:"/order"},{title:"收付帳功能",caption:"收錢、還錢、賒帳",icon:"attach_money",link:"https://github.com/quasarframework"},{title:"投票區",caption:"投票、查看投票結果",icon:"how_to_vote",link:"https://chat.quasar.dev"}];var H={name:"MainLayout",components:{EssentialLink:q,SignUp:A,SignIn:F},data(){return{leftDrawerOpen:!1,essentialLinks:G,alert:!1}},computed:{open(){return this.$store.state.openSignIn},uid(){return this.$store.state.currentUser.id}},methods:{toggle(){this.$store.commit("openSignInDialog")},async tosignOut(){try{const t=Object(w["b"])(C["a"]);await Object(w["d"])(t),localStorage.clear(),this.$store.commit("clearCurrentUser"),this.login=!1,"/"!==this.$route.path&&this.$router.push("/"),this.$q.notify({message:"已登出",color:"positive",icon:"logout"})}catch(t){console.error("登出失敗",t)}},async getCurrentUser(t){const e=Object(v["f"])(C["a"]),a=await Object(v["d"])(Object(v["c"])(e,"user",t));this.$store.commit("setCurrentUserInfo",a.data())},async checkLogin(){const t=localStorage.getItem("currentUser");if(t){const e=JSON.parse(t);this.$store.commit("setCurrentUser",e),await this.getCurrentUser(e.uid)}else console.log("尚未登入")},goto(){"/"!=this.$route.path&&this.$router.push("/")}},mounted(){this.checkLogin()}},T=H,M=a("4d5a"),K=a("e359"),R=a("65c6"),V=a("6ac5"),W=a("9404"),X=a("1c1c"),Y=a("09e3"),Z=Object(l["a"])(T,s,n,!1,null,null,null);e["default"]=Z.exports;h()(Z,"components",{QLayout:M["a"],QHeader:K["a"],QToolbar:R["a"],QBtn:U["a"],QToolbarTitle:V["a"],QDrawer:W["a"],QList:X["a"],QItemLabel:d["a"],QPageContainer:Y["a"],QDialog:Q["a"],QCard:S["a"],QCardSection:I["a"],QCardActions:x["a"]}),h()(Z,"directives",{ClosePopup:D["a"]})}}]);